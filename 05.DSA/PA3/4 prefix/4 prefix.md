# PA3-4 Prefix Report

#### 算法简述

根据KMP算法构造next表，next[k]表示使得前缀$l$是前缀$k$后缀的最长前缀$l$。

对于序列$L(x)=\{x,next[x],next[next[x]],\cdots,0\}$，如果$prefix[i]=S[x-i+1\cdots x]$，则必有$i\in L(x)$，于是，所有前缀在串中出现的次数就是$\sum|L(x)|$.

注意到$L(x)$的单调性，以及$|L(x)|=1+|L(next[x])|$，从1到n对$|L(x)|$进行递推即可。

#### 困难及其解决

本题实现简单，但是思路还是有些难度的。我参考MOOC和讲义上关于next表的论述得出了本题算法。

#### 复杂度分析

空间复杂度O(n).

构造next表和求L(x)的时间复杂度均为O(n)，总时间复杂度O(n).